{% extends 'noter/base.html' %}
{% block title %}Home{% endblock %}
{% block css %}
    {% load static %}
    <link rel="stylesheet" href="{% static 'noter/css/home.css' %}">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@4.5.0/fonts/remixicon.css" rel="stylesheet"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.min.js"></script>
{% endblock %}
{% block content %}
    <!-- {% if messages %}
        {% for message in messages %}
            <div class="alert alert-warning alert-dismissible fade show" role="alert" style="display: flex; justify-content: center; width: 100%;" id="auto-close-alert">
                {{ message }}
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
        {% endfor %}
    {% endif %} -->
    <!-- Assalomu alaykum Home
    <form method="post" action="{% url 'noter:create-list' %}">
        {% csrf_token %}
        <input type="text" name="list_name">
        <input type="text" name="list_color">
        <input type="submit" value="Create List" onchange="this.form.submit()">
    </form>
    {% for list in lists %}
        <p><a href="{% url 'noter:lists' list.id %}">{{list.name}}</a></p>
    {% endfor %}
    <script> -->
    <!-- setTimeout(()=>{
        const alert = document.getElementById('auto-close-alert')
        if(alert){
            $(alert).alert('close');
        }
    }, 2000);
    </script> -->





    <div class="main">
        <button onclick="toggle()" class="button" style="border:none; background-color: transparent;">
            <i class="ri-menu-line"></i>
        </button>
        <div class="menu">
            <div class="menu_header">
                <div class="menu_header_header">
                    <h1><b>Menu</b></h1>
                    <button onclick="toggle()" style="border:none; background-color: transparent;">
                        <i class="ri-menu-line"></i>
                    </button>
                </div>
                <div class="menu_header_header_input">
                    <input type="search" class="form-control" placeholder="Search..." aria-label="Search">
                </div>
            </div>
            <div class="menu_tasks">
                <div class="menu_tasks_header">
                    <b>Tasks</b>
                </div>
                <div class="menu_tasks_buttons">
                    <a class="task_button">
                        <i class="ri-arrow-right-double-line task_button_text"></i>
                        <div class="task_button_text">Upcoming</div>
                        <div class="task_button_number_parent">
                            <div class="task_button_number">12</div>
                        </div>
                    </a>

                    <a class="task_button ticked">
                        <i class="ri-check-double-line task_button_text"></i>
                        <div class="task_button_text">Today</div>
                        <div class="task_button_number_parent">
                            <div class="task_button_number">12</div>
                        </div>
                    </a>

                    <a class="task_button">
                        <i class="ri-calendar-2-line task_button_text"></i>
                        <div class="task_button_text">Calendar</div>
                        <div class="task_button_number_parent">
                            <div class="task_button_number">12</div>
                        </div>
                    </a>

                    <a class="task_button">
                        <i class="ri-file-list-2-line task_button_text"></i>
                        <div class="task_button_text">Sticky Wall</div>
                        <div class="task_button_number_parent">
                            <div class="task_button_number">12</div>
                        </div>
                    </a>
                </div>
            </div>
            <div class="menu_lists">
                <div class="menu_tasks_header">
                    <b>Lists</b>
                </div>
                <div class="menu_tasks_buttons">
                    {% for list in lists %}
                        <a class="menu_list_button" href="{% url 'noter:lists' list.id %}">
                            <div class="i"></div>
                            <div class="list_href_text">{{list.name}}</div>
                        </a>
                    {% endfor %}
                    <button class="menu_list_button" onclick="add_list_div()">
                        <i class="ri-add-line" style="margin: 1vh 1vh;"></i>
                        <div class="menu_list_button_text">Add List</div>
                    </button>
                </div>
            </div>
            <div class="menu_footer"></div>

        </div>
        <div class="list"></div>
        <div class="properties"></div>

        <div class="add_list_toggle">
            <form method="post" action="{% url 'noter:create-list' %}" id="list_form">
                {% csrf_token %}
                <div class="colorSelectionOptionsBack" onclick="colorOpen()"></div>
                <input type="text" name="list_name" placeholder="Enter List" class="submit_list_text">
                <input type="hidden" name="list_color" id="list_color">
                <div class="colorSelection">
                    <div class="colorSelectionButton" onclick="colorOpen()">
                        <u style="text-decoration: none;" class="colorSelectionButtonText">--Select Color--</u>
                        <i class="ri-arrow-down-s-line colorSelectionButtonLogo"></i>
                    </div>
                    <div class="colorSelectionOptions">
                        <div class="colorSelectionOption">
                            <div class="colorSelectionOptionColor" style="width: 3vh; height: 3vh; background-color: #494949; border-radius: 50%; margin:2vh;"></div>
                            Default
                        </div>
                        <div class="colorSelectionOption">
                            <div class="colorSelectionOptionColor" style="width: 3vh; height: 3vh; background-color: #faecc3; border-radius: 50%; margin:2vh;"></div>
                            Kasar
                        </div>
                        <div class="colorSelectionOption">
                            <div class="colorSelectionOptionColor" style="width: 3vh; height: 3vh; background-color: #bba591; border-radius: 50%; margin:2vh;"></div>
                            Light Brown
                        </div>
                        <div class="colorSelectionOption">
                            <div class="colorSelectionOptionColor" style="width: 3vh; height: 3vh; background-color: #336659; border-radius: 50%; margin:2vh;"></div>
                            Maroon green
                        </div>
                        <div class="colorSelectionOption">
                            <div class="colorSelectionOptionColor" style="width: 3vh; height: 3vh; background-color: #0e1c4f; border-radius: 50%; margin:2vh;"></div>
                            Rich blue
                        </div>
                    </div>
                </div>
                <input type="button" onclick="add_list_div()" value="Cancel" class="submit_list_form" style="right: 20vh; background-color: rgb(228, 228, 228);">
                <input type="submit" value="Create List" class="submit_list_form">
            </form>
        </div>
        <div class="add_list_toggle_back" onclick="add_list_div()">
                        
        </div>
    </div>
    <script>
        // function toggle(){
        //     const menu = document.querySelector('.menu')
        //     const button = document.querySelector('.button')
        //     if (menu.style.width == '0'){
        //         button.style.display = 'width'
        //         menu.style.width = '22%'
        //     }
        //     if(menu.style.width == '22%'){
        //         button.style.display = 'block'
        //         menu.style.width = '0'
        //     }
        // }
        document.getElementById("list_form").addEventListener("submit", function(event) {
            var content = document.getElementById("colorSelectionButtonText").innerHTML;

            document.getElementById("list_color").value = content;
        });
        function toggle() {
            const menu = document.querySelector('.menu');
            const button = document.querySelector('.button');

            if (menu.style.marginLeft === '0px' || menu.style.marginLeft === '') {
                button.style.opacity = '100%';
                button.style.visibility = 'visible';
                menu.style.marginLeft = '-500px';
                button.style.marginLeft = '1vh';
            }
            else {
                button.style.opacity = '0%';
                button.style.marginLeft = '-3vh';
                button.style.visibility = 'hidden';
                menu.style.marginLeft = '0px';
            }
        }
        function colorOpen() {
            const menu = document.querySelector('.colorSelectionOptions');
            const back_button = document.querySelector('.colorSelectionOptionsBack')
            const rotation_button = document.querySelector('.colorSelectionButtonLogo')
            if (!menu.classList.contains('visible')) {
                console.log('salom2')
                menu.classList.add('visible');
                back_button.classList.add('visible');
                rotation_button.style.transform = 'rotate(180deg)'
            } else {
                console.log('salom1')
                menu.classList.remove('visible');
                back_button.classList.remove('visible');
                rotation_button.style.transform = 'rotate(0deg)'
            }
        }
        function add_list_div() {
            const menu = document.querySelector('.add_list_toggle');
            const button = document.querySelector('.add_list_toggle_back');

            if (menu.style.display === 'none') {
                button.style.display = 'block';
                menu.style.display = 'grid';
            }
            else {
                button.style.display = 'none';
                menu.style.display = 'none';
            }

        }
        const colorOptions = document.querySelectorAll('.colorSelectionOption');
        const button = document.querySelector('.colorSelectionButtonText');
        colorOptions.forEach(option => {
            option.addEventListener('click', () => {
                const textContent = option.textContent
                const tagText = option.querySelector('.colorSelectionOptionColor')?.textContent || '';
                const pureText = textContent.replace(tagText, '').trim();

                button.innerHTML = pureText

                const menu = document.querySelector('.colorSelectionOptions');
                menu.classList.remove('visible');
                const back_button = document.querySelector('.colorSelectionOptionsBack')
                back_button.classList.remove('visible');

                const rotation_button = document.querySelector('.colorSelectionButtonLogo')
                rotation_button.style.transform = 'rotate(0deg)'

                button.innerHTML += j
            });
        });
    </script>
{% endblock %}